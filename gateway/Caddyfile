:80 {
    log {
        level INFO
    }

    # 后端 API 反向代理
    # 匹配 /api/health 并重写为 /health
    @api_health path /api/health
    handle @api_health {
        rewrite * /health
        reverse_proxy backend:8000
    }

    # 匹配所有 /api/* 请求
    @api path /api/*
    handle @api {
        reverse_proxy backend:8000
    }

    # 前端静态资源反向代理
    # 所有其他请求转发给 frontend 服务
    handle {
        reverse_proxy frontend:80
    }
}
